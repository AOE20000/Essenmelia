{
  "id": "com.essenmelia.data_insight",
  "name": "智能数据洞察",
  "description": "通过动态 UI 与逻辑引擎实时分析您的本地数据。",
  "author": "Essenmelia Lab",
  "version": "2.1.0",
  "icon_code": 58390,
  "icon_font": "MaterialIcons",
  "permissions": [
    "readEvents",
    "writeEvents",
    "notifications"
  ],
  "view": {
    "type": "column",
    "props": {
      "crossAxisAlignment": "stretch"
    },
    "children": [
      {
        "type": "container",
        "props": {
          "padding": [24, 32, 24, 32],
          "color": "#6366F1"
        },
        "child": {
          "type": "column",
          "props": { "crossAxisAlignment": "start" },
          "children": [
            {
              "type": "text",
              "props": {
                "value": "智能洞察中心",
                "fontSize": 24,
                "bold": true,
                "color": "#FFFFFF"
              }
            },
            {
              "type": "sizedbox",
              "props": { "height": 4 }
            },
            {
              "type": "text",
              "props": {
                "value": "环境: ${state.locale} | 模式: ${state.theme}",
                "fontSize": 14,
                "color": "#E0E7FF"
              }
            }
          ]
        }
      },
      {
        "type": "padding",
        "props": { "padding": 16 },
        "child": {
          "type": "column",
          "children": [
            {
              "type": "row",
              "children": [
                {
                  "type": "expanded",
                  "child": {
                    "type": "card",
                    "props": { "margin": 4, "color": "#EEF2FF" },
                    "child": {
                      "type": "column",
                      "children": [
                        {
                          "type": "icon",
                          "props": { "icon": "event", "color": "#6366F1", "size": 28 }
                        },
                        { "type": "sizedbox", "props": { "height": 8 } },
                        {
                          "type": "text",
                          "props": { "value": "${state.count}", "fontSize": 24, "bold": true }
                        },
                        {
                          "type": "text",
                          "props": { "value": "总事件数", "fontSize": 12, "color": "#6B7280" }
                        }
                      ]
                    }
                  }
                },
                {
                  "type": "expanded",
                  "child": {
                    "type": "card",
                    "props": { "margin": 4, "color": "#ECFDF5" },
                    "child": {
                      "type": "column",
                      "children": [
                        {
                          "type": "icon",
                          "props": { "icon": "storage", "color": "#10B981", "size": 28 }
                        },
                        { "type": "sizedbox", "props": { "height": 8 } },
                        {
                          "type": "text",
                          "props": { "value": "${state.dbSize} B", "fontSize": 18, "bold": true }
                        },
                        {
                          "type": "text",
                          "props": { "value": "扩展存储占用", "fontSize": 12, "color": "#6B7280" }
                        }
                      ]
                    }
                  }
                }
              ]
            },
            { "type": "sizedbox", "props": { "height": 16 } },
            {
              "type": "button",
              "props": {
                "value": "测试：添加随机任务",
                "onTap": "addRandomTask"
              }
            }
          ]
        }
      }
    ]
  },
  "logic": {
    "onLoad": [
      { "call": "state.set", "params": { "value": "分析中..." }, "assignTo": "status" },
      { "call": "api.getEvents", "assignTo": "events" },
      { "call": "api.getLocale", "assignTo": "locale" },
      { "call": "api.getThemeMode", "assignTo": "theme" },
      { "call": "api.getDbSize", "assignTo": "dbSize" },
      { "call": "list.length", "params": { "list": "${state.events}" }, "assignTo": "count" },
      { "call": "state.set", "params": { "value": "就绪" }, "assignTo": "status" }
    ],
    "actions": {
      "addRandomTask": [
        { 
          "call": "api.addEvent", 
          "params": {
            "title": "来自扩展的随机任务", 
            "description": "这是通过 api.addEvent 动态创建的任务",
            "tags": ["扩展", "自动生成"]
          } 
        },
        { "call": "api.showSnackBar", "params": { "message": "任务已添加！" } },
        { "call": "api.getEvents", "assignTo": "events" },
        { "call": "list.length", "params": { "list": "${state.events}" }, "assignTo": "count" }
      ]
    }
  }
}
