{
  "id": "external_call",
  "name": "外部调用入口扩展",
  "description": "提供标准化的 API 调用入口，记录所有外部交互审计日志。",
  "author": "Essenmelia",
  "version": "1.0.0",
  "icon_code": 61583,
  "icon_font": "MaterialIcons",
  "permissions": [
    "read_events",
    "ui_snack_bar"
  ],
  "view": {
    "type": "scaffold",
    "appBar": {
      "title": "调用记录",
      "actions": [
        {
          "type": "iconButton",
          "icon": 58000,
          "onPressed": "clearLogs"
        }
      ]
    },
    "body": {
      "type": "listView",
      "items": "${state.logs}",
      "itemTemplate": {
        "type": "card",
        "margin": [0, 0, 0, 12],
        "child": {
          "type": "listTile",
          "title": "${item.method}",
          "subtitle": "${item.timestamp}",
          "trailing": {
            "type": "icon",
            "icon": "${item.success ? 58631 : 58117}",
            "color": "${item.success ? 'green' : 'red'}"
          }
        }
      }
    }
  },
  "logic": {
    "onLoad": [
      { "state.set": { "logs": [] } }
    ],
    "actions": {
      "clearLogs": [
        { "state.set": { "logs": [] } }
      ],
      "handleRequest": [
        { "api.call": { "method": "${params.method}", "params": "${params.args}", "target": "result" } },
        { "state.push": { "target": "logs", "value": { "method": "${params.method}", "timestamp": "now", "success": true } } }
      ]
    }
  }
}
